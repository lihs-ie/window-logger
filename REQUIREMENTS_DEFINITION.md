# REQUIREMENTS_DEFINITION.md

## プロジェクト概要
Windows 11用のフォアグラウンドウィンドウタイトル記録ツール

## 機能要件

### 1. 基本機能
- **ウィンドウタイトル取得**: 最前面のウィンドウ（フォアグラウンドウィンドウ）のタイトルを取得
- **自動記録**: 最前面のウィンドウが変更される度にタイトルの取得と記録を実行
- **作業履歴作成**: パソコンの作業履歴として活用できる記録の生成

### 2. 起動・終了
- **自動開始**: 起動と同時に記録を開始
- **タスクトレイ常駐**: 起動時はタスクトレイに格納される状態
- **終了による停止**: アプリケーションを終了させることで記録を停止

### 3. タスクトレイ機能
- **最小化**: タスクトレイに移動
- **最大化**: 機能しない（要件通り）
- **閉じる**: アプリケーションを終了

### 4. データ保存
- **保存場所**: アプリケーションフォルダ
- **保存形式**: HTML形式のみ
- **保存内容**: 
  - ウィンドウタイトル
  - 記録日時
  - 時系列での表示

### 5. HTMLエクスポート
- **出力形式**: HTML形式のファイル
- **表示方式**: 時系列表示
- **閲覧方法**: ウェブブラウザ等での観覧

## 非機能要件

### 1. 対象環境
- **OS**: Windows 11 (primary), Windows 10 (compatibility)
- **フレームワーク**: .NET 8

### 2. 技術制約
- **通知機能**: 不要
- **設定画面**: 不要
- **データ暗号化**: 不要
- **ネットワーク機能**: 不要
- **アクセス制御**: 不要

### 3. パフォーマンス
- **リソース消費**: 最小限（バックグラウンド動作）
- **応答性**: ウィンドウ変更を即座に検知

## 技術要件

### 1. アーキテクチャ
- **設計**: 関数型ドメイン駆動設計（DDD）
- **開発手法**: テスト駆動開発（TDD）
- **層構成**: 4層アーキテクチャ（Domain, Application, Infrastructure, Presentation）

### 2. 主要技術
- **Windows API**: Microsoft.Windows.CsWin32
- **DI/ライフサイクル**: Microsoft.Extensions.Hosting
- **ログ**: Microsoft.Extensions.Logging
- **テスト**: xUnit + FluentAssertions

### 3. 具体的実装
- **API呼び出し**: `GetForegroundWindow()` + `GetWindowText()`
- **タスクトレイ**: `NotifyIcon`クラス
- **リソース管理**: `IDisposable`パターン
- **HTML出力**: `System.Text.Json`による構造化データ出力

## 完了条件
- [x] 環境構築完了
- [ ] ドメイン層実装（純粋関数）
- [ ] アプリケーション層実装（ワークフロー）
- [ ] インフラ層実装（Windows API統合）
- [ ] プレゼンテーション層実装（タスクトレイ）
- [ ] HTMLエクスポート機能
- [ ] 全機能の統合テスト
- [ ] Windows 11での動作確認

## 制約事項
- ハードコードの完全禁止
- 外部サービス依存の排除（domain層）
- セキュリティ要件なし（シンプル設計重視）
- 最小限のUI（タスクトレイのみ）